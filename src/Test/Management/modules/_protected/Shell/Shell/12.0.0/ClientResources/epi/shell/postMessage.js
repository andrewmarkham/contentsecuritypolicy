//>>built
define("epi/shell/postMessage",["dojo/Evented","dojo/on"],function(_1,on){var _2=new _1(),_3,_4;function _5(){return _4||window.top;};function _6(){_3&&_3.remove();_3=on(_5(),"message",function(_7){var _8=_7.data;_8&&_8.id&&_2.emit.apply(_2,[_8.id,_8.message]);},false);};var _9={setContext:function(_a){_4=_a;_6();},publish:function(_b,_c,_d){var i=0;if(_d){_d=_d instanceof Array?_d:[_d];}else{_d=_5().frames;}for(;i<_d.length;i++){try{_d[i].postMessage({id:_b,data:_c},"*");}catch(ex){console.error(ex);}}},subscribe:function(_e,_f){return _2.on.apply(_2,arguments);}};_6();return _9;});