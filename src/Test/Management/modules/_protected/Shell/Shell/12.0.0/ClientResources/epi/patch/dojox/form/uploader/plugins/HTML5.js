//>>built
define("epi/patch/dojox/form/uploader/plugins/HTML5",["dojo/_base/lang","dojox/form/Uploader","dojox/form/uploader/plugins/HTML5"],function(_1,_2,_3){_1.mixin(_3.prototype,{createXhr:function(){var _4=new XMLHttpRequest();var _5;_4.upload.addEventListener("progress",_1.hitch(this,"_xhrProgress"),false);_4.addEventListener("load",_1.hitch(this,"_xhrProgress"),false);_4.addEventListener("error",_1.hitch(this,function(_6){this.onError(_6);clearInterval(_5);}),false);_4.addEventListener("abort",_1.hitch(this,function(_7){this.onAbort(_7);clearInterval(_5);}),false);_4.onreadystatechange=_1.hitch(this,function(){if(_4.readyState===4){clearInterval(_5);var _8;if(_4.responseText){try{_8=JSON.parse(_4.responseText.replace(/^\{\}&&/,""));}catch(e){this.onError({message:e.message,data:_4.responseText,statusCode:_4.status,headers:_4.getAllResponseHeaders()});return;}}this.onComplete(_8);}});_4.open("POST",this.getUrl());_5=setInterval(_1.hitch(this,function(){try{if(typeof (_4.statusText)){}}catch(e){clearInterval(_5);}}),250);return _4;}});_3.prototype.createXhr.nom="createXhr";});