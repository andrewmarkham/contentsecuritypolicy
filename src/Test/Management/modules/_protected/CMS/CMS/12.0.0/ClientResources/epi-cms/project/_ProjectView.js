//>>built
define("epi-cms/project/_ProjectView",["dojo/_base/declare","dojo/_base/lang","dojo/aspect","dojo/dom-class","dojo/dom-geometry","dojo/on","dojo/when","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/layout/_LayoutWidget","epi/shell/command/builder/MenuAssembler","epi/shell/command/builder/ButtonBuilder","epi/shell/widget/_ModelBindingMixin","./CreateNewDraftConfirmationDialog","epi/i18n!epi/cms/nls/episerver.cms.components.project"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a,_b,_c,_d,_e){return _1([_9,_7,_8,_c],{model:null,commandProvider:null,res:_e,_menuAssembler:null,postMixInProperties:function(){this.inherited(arguments);if(!this.model){this.own(this.model=this.commandProvider=this._createViewModel());}},_createViewModel:function(){},buildRendering:function(){this.inherited(arguments);this._setupList();this._setupProjectMenu();},startup:function(){if(this._started){return;}this.inherited(arguments);this.model.initialize();},_setupList:function(){var _f=this.model,_10=this.itemList;function _11(_12){if(_12.existingProjectItems.length!==0){new _d({projectItems:_12.existingProjectItems,contentReferences:_12.contentReferences,onAction:function(_13){if(_13){_f.addProjectItems(_12.contentReferencesToAdd).then(_10.setSelection.bind(_10));}}}).show();}else{if(_12.contentReferencesToAdd.length>0){_f.addProjectItems(_12.contentReferencesToAdd);}}};this.own(on(this.model,"refresh",_10.refresh.bind(_10)),on(this.model,"selected-project-items-updated",function(_14){_10.selectItems(_14);}),on(this.domNode,"selection-changed",function(e){_f.updateActivityFeed(e.items);}),on(this.domNode,"active-items-changed",function(e){_f.set("selectedProjectItems",e.items);}),on(this.domNode,"itemaction",function(e){_f.namedCommands.editProjectItem.execute();}),on(this.domNode,"itemremove",function(){_f.namedCommands.removeProjectItem.execute();}),on(this.domNode,"itemsdropped",function(e){_f.canAddContent(e.items).then(_11);}),on(this.model,"clear-selection",function(){_10.clearSelection();}),on(this.model,"item-removed",function(){_10.clearSelection();_10.focus();}));},_setupProjectMenu:function(){this.own(this._menuAssembler=new _a({configuration:[{builder:new _b({settings:{"class":"epi-disabledDropdownArrow",showLabel:false}}),category:"projectButton",target:this.toolbarGroupNode},{builder:new _b({settings:{"class":"epi-floatRight",showLabel:false}}),category:"project-comments",target:this.projectCommentsToolbar},{builder:new _b(),category:"project-activities",target:this.toolbarGroupNode}],commandSource:this.model}));},_publishMenuClickHandler:function(){this.model.refreshProject(false);},_setCreatedAttr:{node:"createdNode",type:"innerText"},_setCreatedByAttr:{node:"createdByNode",type:"innerText"},_setDndEnabledAttr:function(_15){this.itemList.set("dndEnabled",_15);},_setProjectItemQueryAttr:function(_16){var _17=_16?this.model.projectItemStore:null;this.itemList.updateQuery(_17,_16);},_setProjectItemSortOrderAttr:function(_18){this.itemList.set("sortOrder",_18);},_setNotificationMessageAttr:function(_19){this.itemList.set("notificationMessage",_19);},_setProjectStatusAttr:function(_1a){this.projectStatusMessageNode.textContent=_1a;_4.toggle(this.projectStatusMessageNode,"dijitHidden",!_1a);},_setContentLanguageAttr:function(_1b){this.itemList.set("contentLanguage",_1b);}});});