//>>built
require({cache:{"url:epi-cms/widget/templates/PersonalizationSelector.html":"<div class=\"epi-menu--inverted\">\r\n    <div class=\"epi-dijitTooltipContainer\">\r\n        <div class=\"epi-invertedTooltip\">\r\n            <div class=\"epi-tooltipDialogTop\">\r\n                <span data-dojo-attach-point=\"header\">${resources.whocansee}</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"epi-tooltipDialogContent--max-height\">\r\n            <div data-dojo-type=\"dijit/Menu\" data-dojo-attach-point=\"visitorGroupsMenu\" style=\"width:100%\"></div>\r\n            <div class=\"epi-menuSeparator\" tabindex=\"-1\"></div>\r\n            <div data-dojo-type=\"dijit/Menu\" data-dojo-attach-point=\"filterOptionsMenu\" style=\"width:100%\">\r\n                <div data-dojo-attach-point=\"rdEveryone\" data-dojo-type=\"epi/shell/widget/RadioMenuItem\" data-dojo-props=\"label:'${resources.everyone}', value: ''\"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("epi-cms/widget/PersonalizationSelector",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/Stateful","dojo/when","dojox/html/entities","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/CheckedMenuItem","epi/dependency","dojo/text!./templates/PersonalizationSelector.html","epi/i18n!epi/cms/nls/episerver.cms.contentediting.editors.contentarea.personalize","dijit/Menu","epi/shell/widget/RadioMenuItem"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){return _2([_7,_8,_9],{templateString:_c,model:null,resources:_d,postMixInProperties:function(){this.inherited(arguments);if(!this.store){var _e=_b.resolve("epi.storeregistry");this.store=_e.get("epi.cms.visitorgroup");}},postCreate:function(){this.inherited(arguments);this.own(this.rdEveryone.on("change",_3.hitch(this,"restoreDefault")),this.model.watch("roleIdentities",_3.hitch(this,function(){if(!this.rdEveryone.checked&&this.model.roleIdentities&&this.model.roleIdentities.length===0){this.restoreDefault();}})));_5(this.store.query(),_3.hitch(this,function(_f){if(!this._destroyed){this.set("visitorGroups",_f);}}));},restoreDefault:function(){_1.forEach(this.visitorGroupsMenu.getChildren(),function(_10){_10.set("checked",false);});this.rdEveryone.set("checked",true);this.model.modify(function(){this.model.resetRoleIdentities();},this);},_setVisitorGroupsAttr:function(_11){this._set("visitorGroups",_11);if(!this.model.hasAnyRoles()){this.rdEveryone.set("checked",true);}_1.forEach(_11,function(_12){var _13=new _a({label:_6.encode(_12.name),visitorgroupId:_12.id,checked:this.model.isRoleSelected(_12.id)});this.own(_13.watch("checked",_3.hitch(this,function(_14,_15,_16){this.model.modify(function(){this.model.selectRole(_12.id,_16);},this);this.rdEveryone.set("checked",!this.model.hasAnyRoles());})));this.visitorGroupsMenu.addChild(_13);},this);}});});