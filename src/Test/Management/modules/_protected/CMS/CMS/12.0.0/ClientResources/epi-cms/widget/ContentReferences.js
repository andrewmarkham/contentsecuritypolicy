//>>built
require({cache:{"url:epi-cms/widget/templates/ContentReferences.html":"<div class=\"epi-contentReferences\">\r\n    <div data-dojo-attach-point=\"contentReferencesNotificationBar\" class=\"epi-notificationBar epi-notificationBarWithBorders epi-notificationBarItem\">\r\n        <div data-dojo-attach-point=\"contentReferencesNotificationNode\" class=\"epi-notificationBarText\" ></div>\r\n    </div>\r\n    <div class=\"epi-captionPanel\" data-dojo-attach-point=\"captionPanelNode\">\r\n        <strong data-dojo-attach-point=\"totalLinksNode\"></strong>\r\n        <div class=\"epi-floatRight\">\r\n            <button class=\"epi-chromelessButton\"\r\n                    data-dojo-type=\"dijit/form/Button\"\r\n                    data-dojo-attach-event=\"onClick:fetchData\"\r\n                    data-dojo-props=\"iconClass:'epi-iconReload'\">${res.buttons.refresh}</button>\r\n        </div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"gridNode\"></div>\r\n</div>\r\n"}});define("epi-cms/widget/ContentReferences",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/keys","dojo/when","epi-cms/dgrid/formatters","epi/dependency","dgrid/tree","./_GridWidgetBase","./viewmodel/ContentReferencesViewModel","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/Evented","epi/shell/widget/_ModelBindingMixin","dojo/text!./templates/ContentReferences.html","epi/i18n!epi/cms/nls/episerver.cms.widget.contentreferences","dijit/form/Button"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12){return _1([_b,_d,_e,_f,_10],{res:_12,templateString:_11,storeKeyName:"epi.cms.referenced-content",contextChangeEvent:"dblclick",trackActiveItem:false,ignoreVersionWhenComparingLinks:false,modelBindingMap:{notification:["notification"],notificationBarStyle:["notificationBarStyle"],numberOfReferences:["numberOfReferences"],showToolbar:["showToolbar"],showGrid:["showGrid"],totalLinks:["totalLinks"]},constructor:function(_13){this.model=_2.mixin(new _c(),_13);this.own(this.model);},_setTotalLinksAttr:{node:"totalLinksNode",type:"innerText"},_setNotificationAttr:{node:"contentReferencesNotificationNode",type:"innerText"},_setNotificationBarStyleAttr:function(_14){switch(_14){case 1:_3.add(this.contentReferencesNotificationBar,"epi-statusIndicator epi-statusIndicatorOk");break;case 2:_3.add(this.contentReferencesNotificationBar,"epi-statusIndicator epi-statusIndicatorWarning");break;}},_setShowToolbarAttr:function(_15){_5.set(this.captionPanelNode,"display",_15?"":"none");},_setShowGridAttr:function(_16){_5.set(this.grid.domNode,"visibility",_16?"visible":"hidden");},postMixInProperties:function(){this.inherited(arguments);this.store=this.model.getUpdatedStore(this.store);},buildRendering:function(){var _17=this._getLinkTemplate();var _18=_2.mixin({columns:{name:_a({renderCell:_2.hitch(this,"_renderContentItem"),shouldExpand:function(){return true;}}),language:{className:"epi-width10",renderCell:function(obj,_19,_1a){if(!_19){return;}_7(_9.resolve("epi.shell.Profile").getContentLanguage(),function(_1b){if(_19!==_1b){_1a.textContent=_19;}});}},treePath:{className:"epi-width50",formatter:function(_1c){return _8.path(_1c,{skipEncode:true,skipDefaultClass:true});}},uri:{className:"epi-width10",label:" ",formatter:function(_1d){return _1d?_17:"";},sortable:false}},store:this.store,query:{ids:this.model.contentItems.map(function(_1e){return _1e.contentLink;})},showHeader:false},this.defaultGridMixin);this.inherited(arguments);this.grid=new this._gridClass(_18,this.gridNode);_3.toggle(this.contentReferencesNotificationBar,"dijitHidden",this.model.mode==="show");},startup:function(){this.inherited(arguments);this.grid.on(".dgrid-column-uri a:click",_2.hitch(this,"_onChangeContext"));},fetchData:function(){this.grid.refresh();},_onChangeContext:function(e){var row=this.grid.row(e),_1f={uri:row.data.uri};if(_1f.uri){this._requestNewContext(_1f,{sender:this});this.emit("viewReference");}},_getLinkTemplate:function(){var _20=_4.create("a",{"class":"epi-visibleLink",innerHTML:_12.view.label,title:_12.view.tooltip});return _20.outerHTML;}});});