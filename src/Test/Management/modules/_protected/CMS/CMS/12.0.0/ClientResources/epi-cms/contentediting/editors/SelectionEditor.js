//>>built
define("epi-cms/contentediting/editors/SelectionEditor",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/on","dojox/html/entities","dijit/form/Select","dijit/MenuItem","dijit/MenuSeparator","epi/shell/layout/_LayoutWidget","epi/shell/widget/_ValueRequiredMixin"],function(_1,_2,_3,_4,on,_5,_6,_7,_8,_9,_a){return _2([_9,_6,_a],{actualValue:null,value:null,maxHeight:-1,postMixInProperties:function(){this.inherited(arguments);this.set("selections",this.selections);this.actualValue=this.value;},_setSelectionsAttr:function(_b){this.set("options",_1.map(_b,function(_c){return {label:_5.encode(_c.text),value:_c.value,selected:(_c.value===this.value)||(!_c.value&&!this.value)};},this));},postCreate:function(){this.inherited(arguments);this.own(on(this,"change",_3.hitch(this,function(){if(!this.disabled){this.validate();}this.onLayoutChanged();})));},_getMenuItemForOption:function(_d){var _e=null;if(_d.type==="separator"){_e=new _8();}else{var _f=_3.hitch(this,"_setValueAttr",_d);_e=new _7({option:_d,label:_d.label||this.emptyLabel,onClick:_f,disabled:_d.disabled||false});_e.focusNode.setAttribute("role","listitem");}this.own(_e);return _e;},_getValueFromOpts:function(){var _10=this.getOptions()||[];if(!this.multiple&&_10.length){var _11=_1.filter(_10,function(i){return i.selected;})[0];if(_11&&_11.value!==undefined){return _11.value;}else{return null;}}else{if(this.multiple){return _1.map(_1.filter(_10,function(i){return i.selected;}),function(i){return i.value;})||[];}}return "";},_setValueAttr:function(_12,_13){var _14=this.getOptions()||[];if(_12===null||typeof _12!="object"){_12=_1.filter(_14,function(i){return (i.value===_12)||(!i.value&&!_12);});}if(!_3.isArray(_12)){_12=[_12];}if(this._onChangeActive){var _15=_12[0]?_12[0].value:null;this._pendingOnChange=this.actualValue!==_15;this.actualValue=_15;}_1.forEach(_14,function(i){i.selected=_1.some(_12,function(v){return v.value===i.value;});});var val=_1.map(_12,function(i){return i.value;}),_16=_1.map(_12,function(i){return i.label;});this._set("value",this.multiple?val:val[0]);this._setDisplay(this.multiple?_16:_16[0]);this._updateSelection();this._handleOnChange(this.value,_13);},_updateSelection:function(){this._set("value",this._getValueFromOpts());var _17=this.value;if(_17!==undefined){if(!_3.isArray(_17)){_17=[_17];}_1.forEach(this._getChildren(),function(_18){var _19=_1.some(_17,function(v){return _18.option&&(v===_18.option.value);});_18.domNode.setAttribute("aria-selected",_19);},this);}},validator:function(_1a,_1b){}});});